$.fn.extend({fiHandler:function(e){e.stopPropagation();this.removeClass("opacity "+this.tp.cls);if(this.tp.cb){this.tp.cb()}this.off("webkitAnimationEnd");this.tp.cb=undefined;this.tp.duration=this.tp.cls=""},foHandler:function(e){e.stopPropagation();this.addClass("none").removeClass(this.tp.cls);if(this.tp.cb){this.tp.cb()}this.off("webkitAnimationEnd");this.tp.cb=undefined;this.tp.duration=this.tp.cls=""},fi:function(cb){this.tp={cb:undefined,duration:"",cls:""};this.tp.cls="ani-fadeIn";if(arguments){for(var prop in arguments){switch(typeof arguments[prop]){case"function":this.tp.cb=arguments[prop];break;case"number":this.tp.duration=arguments[prop];this.tp.cls+=this.tp.duration;break}}}this.on("webkitAnimationEnd",this.fiHandler.bind(this)).addClass("opacity "+this.tp.cls).removeClass("none");return this},fo:function(cb){this.tp={cb:undefined,duration:"",cls:""};this.tp.cls="ani-fadeOut";if(arguments){for(var prop in arguments){switch(typeof arguments[prop]){case"function":this.tp.cb=arguments[prop];break;case"number":this.tp.duration=arguments[prop];this.tp.cls+=this.tp.duration}}}this.on("webkitAnimationEnd",this.foHandler.bind(this)).addClass(this.tp.cls);return this}});var Utils=new function(){this.preloadImage=function(ImageURL,callback,realLoading){var rd=realLoading||false;var i,j,haveLoaded=0;var $num=$(".num");for(i=0,j=ImageURL.length;i<j;i++){(function(img,src){img.onload=function(){haveLoaded+=1;var num=Math.ceil(haveLoaded/ImageURL.length*100);if(rd){$num.html("- "+num+"% -")}if(haveLoaded==ImageURL.length&&callback){setTimeout(callback,500)}};img.onerror=function(){};img.onabort=function(){};img.src=src})(new Image,ImageURL[i])}},this.lazyLoad=function(){var a=$(".lazy");var len=a.length;var imgObj;var Load=function(){for(var i=0;i<len;i++){imgObj=a.eq(i);imgObj.attr("src",imgObj.attr("data-src"))}};Load()};this.browser=function(t){var u=navigator.userAgent;var u2=navigator.userAgent.toLowerCase();var p=navigator.platform;var browserInfo={trident:u.indexOf("Trident")>-1,presto:u.indexOf("Presto")>-1,webKit:u.indexOf("AppleWebKit")>-1,gecko:u.indexOf("Gecko")>-1&&u.indexOf("KHTML")==-1,mobile:!!u.match(/AppleWebKit.*Mobile.*/),ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:u.indexOf("Android")>-1||u.indexOf("Linux")>-1,iPhone:u.indexOf("iPhone")>-1,iPad:u.indexOf("iPad")>-1,webApp:u.indexOf("Safari")==-1,iosv:u.substr(u.indexOf("iPhone OS")+9,3),weixin:u2.match(/MicroMessenger/i)=="micromessenger",taobao:u.indexOf("AliApp(TB")>-1,win:p.indexOf("Win")==0,mac:p.indexOf("Mac")==0,xll:p=="X11"||p.indexOf("Linux")==0,ipad:navigator.userAgent.match(/iPad/i)!=null?true:false};return browserInfo[t]};this.g=function(id){return document.getElementById(id)};this.limitNum=function(obj){var value=$(obj).val();var length=value.length;if(length>11){value=value.substring(0,11);$(obj).val(value)}}};var Media=new function(){this.mutedEnd=false;this.WxMediaInit=function(){var _self=this;if(!Utils.browser("weixin")){this.mutedEnd=true;return}if(!Utils.browser("iPhone")){_self.mutedEnd=true;return}document.addEventListener("WeixinJSBridgeReady",function(){var $media=$(".iosPreload");$.each($media,function(index,value){_self.MutedPlay(value["id"]);if(index+1==$media.length){_self.mutedEnd=true}})},false)},this.MutedPlay=function(string){var str=string.split(",");var f=function(id){var media=Utils.g(id);media.volume=0;media.play();media.pause();media.volume=1;media.currentTime=0};if(!(str.length-1)){f(str[0]);return 0}str.forEach(function(value,index){f(value)})},this.playMedia=function(id){var _self=this;var clock=setInterval(function(){if(_self.mutedEnd){Utils.g(id).play();clearInterval(clock)}},20)}};Media.WxMediaInit();var options={el:"#iCreative",data:{server_data:{is_end:!!parseInt($("#is_end").val()),have_guanzhu:!!parseInt($("#have_guanzhu").val()),isVip:!!parseInt($("#is_vip").val()),goRegist:!!parseInt($("#goRegist").val()),haveFill:!!parseInt($("#haveFill").val()),prizeType:parseInt($("#prizeType").val()),province:[{province:"江西省"},{province:"浙江省"},{province:"江苏省"}],city:[{city:"杭州市"},{city:"嘉兴市"},{city:"温州市"}],address:[{id:"1",name:"门店名称"},{id:"2",name:"门店名称"},{id:"3",name:"门店名称"}],name:"",tel:"",select_province:"",select_city:"",select_address:"",shop_id:0,myInfo:{province:"",city:"",shop:""}},ploading:{visible:true},pwebgl:{visible:false},p1:{visible:false},p2:{visible:false},pfill:{visible:false},pend:{visible:false},pquery:{visible:false},paddress:{visible:false},pvideo:{visible:false},prule:{visible:false},hpwarn:{visible:false},pwait:{visible:false},pages:{p1:"p1",p2:"p2"},router:[]},methods:{pfill_btn_submit:function(){var number=this.server_data.tel;var name=this.server_data.name;var patt=/^1(3|4|5|7|8)\d{9}$/;if(name==""){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请输入姓名";this.pmask.visible=true;return}if(!patt.test(number)){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请输入正确的手机号";this.pmask.visible=true;return}if(this.server_data.select_province==""){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请选择省份";this.pmask.visible=true;return}if(this.server_data.select_city==""){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请选择城市";this.pmask.visible=true;return}if(this.server_data.select_address==""){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请选择门店";this.pmask.visible=true;return}_uploadData.fillInfo()},onPfillProvinceChangeHandle:function(e){console.log(this.server_data.select_province)},onPfillCityChangeHandle:function(e){console.log(this.server_data.select_city)},onPfillAddressChangeHandle:function(e){this.server_data.shop_id=e.target.selectedOptions[0].getAttribute("shopid");console.log(this.server_data.select_address)},onPaddress_btn_xx:function(){this.paddress.visible=false},back:function(){var len=this.router.length;if(len>0){var page=this.router[len-1];this[page].visible=true;this.router.splice(len-1,1)}}},delimiters:["$[","]"]};var vm=new Vue(options);var main=new function(){this.touch={ScrollObj:undefined,isScroll:false,limitUp:0,limitDown:undefined,overlimit:false,lastX:0,lastY:0,newX:0,newY:0,delta_X:0,delta_Y:0,scrollY:0,touchAllow:true,fingerNumber:0,distance:0,angle:0,delta_angle:0,time:0,offsetTime:0};this.bgm={obj:document.getElementById("bgm"),id:"bgm",isPlay:false,button:$(".music-btn")};this.V={id:"video",currentTime:0,isPlay:false,obj:document.getElementById("video")};this.assetsUrl="assets/";this.picUrl=this.assetsUrl+"images/";this.ImageList=[{url:picUrl+"weile.png",group:"clouds"},{url:picUrl+"phone.png",group:"scene"}];this.RAF=undefined};main.init=function(){};main.start=function(){};main.loadCallBack=function(){};main.prule=function(){$(".P_rule").fi();main.scrollInit(".rule-txt",0)};main.prulelaeve=function(){$(".P_rule").fo(function(){$(".rule-txt")[0].style.webkitTransform="translate3d(0,0,0)"})};main.scrollInit=function(selector){this.touch.ScrollObj=$(selector);this.touch.container=$(selector).parent();this.touch.StartY=0;this.touch.NewY=0;this.touch.addY=0;this.touch.scrollY=0;this.touch.limitDown=this.touch.ScrollObj.height()<this.touch.container.height()?0:this.touch.container.height()-this.touch.ScrollObj.height()};main.limitNum=function(obj){var value=obj.value;var length=value.length;if(length>11){value=value.substring(0,11);obj.value=value}};main.playbgm=function(){Media.playMedia(this.bgm.id);this.bgm.button.addClass("ani-bgmRotate");this.bgm.isPlay=true};main.pausebgm=function(){this.bgm.obj.pause();this.bgm.button.removeClass("ani-bgmRotate");this.bgm.isPlay=false};main.startRender=function(){var loop=function(){main.RAF=window.requestAnimationFrame(loop)};loop()};main.stopRender=function(){window.cancelAnimationFrame(main.RAF)};main.addEvent=function(){$(window).on("orientationchange",function(e){if(window.orientation==0||window.orientation==180){vm.hpwarn.visible=false}else if(window.orientation==90||window.orientation==-90){vm.hpwarn.visible=true}})};main.addEvent();