var onJQAnimationEndHandle=function(option){switch(option.type){case"fadeIn":this.removeClass("opacity "+option.ani);break;case"fadeOut":this.hide().removeClass(option.ani);break}if(option.callback){option.callback.call(this)}this.off("webkitAnimationEnd").css({animationDuration:""})};$.fn.extend({fi:function(option){var _this=this;var options={ani:"ani-fadeIn",duration:"500",callback:undefined,type:"fadeIn"};if(option){jQuery.extend(options,option)}this.on("webkitAnimationEnd",function(e){e.stopPropagation();onJQAnimationEndHandle.call(_this,options)}).css({animationDuration:options.duration+"ms"}).addClass("opacity "+options.ani).show();return this},fo:function(option){var _this=this;var options={ani:"ani-fadeOut",duration:"500",callback:undefined,type:"fadeOut"};if(option){jQuery.extend(options,option)}this.on("webkitAnimationEnd",function(e){e.stopPropagation();onJQAnimationEndHandle.call(_this,options)}).css({animationDuration:options.duration+"ms"}).addClass(options.ani);return this}});if(Object.assign===undefined){(function(){Object.assign=function(target){"use strict";if(target===undefined||target===null){throw new TypeError("Cannot convert undefined or null to object")}var output=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&source!==null){for(var nextKey in source){if(Object.prototype.hasOwnProperty.call(source,nextKey)){output[nextKey]=source[nextKey]}}}}return output}})()}var Utils=new function(){this.ImageLoader=function ImageLoader(){this.total=0;this.haveload=0;this.percent=0;this.complete=false;this.version="?v1"};this.lazyLoad=function(){var a=$(".lazy");var len=a.length;var imgObj;var Load=function(){for(var i=0;i<len;i++){imgObj=a.eq(i);imgObj.attr("src",imgObj.attr("data-src"))}};Load()};this.browser=function(t){var u=navigator.userAgent;var u2=navigator.userAgent.toLowerCase();var p=navigator.platform;var browserInfo={trident:u.indexOf("Trident")>-1,presto:u.indexOf("Presto")>-1,webKit:u.indexOf("AppleWebKit")>-1,gecko:u.indexOf("Gecko")>-1&&u.indexOf("KHTML")==-1,mobile:!!u.match(/AppleWebKit.*Mobile.*/),ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:u.indexOf("Android")>-1||u.indexOf("Linux")>-1,iPhone:u.indexOf("iPhone")>-1,iPad:u.indexOf("iPad")>-1,webApp:u.indexOf("Safari")==-1,iosv:u.substr(u.indexOf("iPhone OS")+9,3),weixin:u2.match(/MicroMessenger/i)=="micromessenger",taobao:u.indexOf("AliApp(TB")>-1,win:p.indexOf("Win")==0,mac:p.indexOf("Mac")==0,xll:p=="X11"||p.indexOf("Linux")==0,ipad:navigator.userAgent.match(/iPad/i)!=null?true:false};return browserInfo[t]};this.g=function(id){return document.getElementById(id)};this.limitNum=function(obj){var value=$(obj).val();var length=value.length;if(length>11){value=value.substring(0,11);$(obj).val(value)}}};Object.assign(Utils.ImageLoader.prototype,{load:function(urls,onEveryLoad,onComplete){var result={0:[]};this.total=urls.length;var _this=this;start();function onLoad(e){if(Object.prototype.hasOwnProperty.call(urls[_this.haveload],"group")){var group=urls[_this.haveload].group;if(result[group]instanceof Array==false){result[group]=[]}result[group].push(this)}else{result[0].push(this)}_this.haveload++;_this.percent=Math.floor(_this.haveload/_this.total*100);onEveryLoad(_this.percent);this.onload=null;if(_this.percent==100){_this.complete=true;onComplete(result);return}var img=new Image;img.onload=onLoad;img.src=urls[_this.haveload].url+_this.version}function start(){var img=new Image;img.onload=onLoad;img.src=urls[_this.haveload].url+_this.version}}});var Media=new function(){this.mutedEnd=false;this.WxMediaInit=function(){var _self=this;if(!Utils.browser("weixin")){this.mutedEnd=true;return}if(!Utils.browser("iPhone")){_self.mutedEnd=true;return}document.addEventListener("WeixinJSBridgeReady",function(){var $media=$(".iosPreload");$.each($media,function(index,value){_self.MutedPlay(value["id"]);if(index+1==$media.length){_self.mutedEnd=true}})},false)};this.MutedPlay=function(string){var str=string.split(",");var f=function(id){var media=Utils.g(id);media.volume=0;media.play();media.pause();media.volume=1;media.currentTime=0};if(!(str.length-1)){f(str[0]);return 0}str.forEach(function(value,index){f(value)})};this.playMedia=function(id){var _self=this;var clock=setInterval(function(){if(_self.mutedEnd){Utils.g(id).play();clearInterval(clock)}},20)}};Media.WxMediaInit();var options={el:"#iCreative",data:{server_data:{is_end:!!parseInt($("#is_end").val()),have_guanzhu:!!parseInt($("#have_guanzhu").val()),isVip:!!parseInt($("#is_vip").val()),goRegist:!!parseInt($("#goRegist").val()),haveFill:!!parseInt($("#haveFill").val()),prizeType:parseInt($("#prizeType").val()),province:[],city:[],address:[],name:"",tel:"",select_province:"",select_city:"",select_address:"",shop_id:0,myInfo:{province:"",city:"",shop:""}},ios:Utils.browser("ios"),ploading:{visible:false},pwebgl:{visible:false},p1:{visible:false},p2:{visible:false},pprize:{visible:false},pfill:{visible:false},paddress:{visible:false},pvideo:{visible:false},pend:{visible:false},pshare:{visible:false},pquery:{visible:false},pguanzhu:{visible:false},prule:{visible:false},palert:{visible:false,type:"",choice:{fill:"fill",normal:"normal",reg:"reg"},fontSize:"",content:"",title:"",txt:{fill:"你还未填写领奖信息，<br>赶快去填写吧",reg:"为了确保星球领奖者的真实性,<br>系统需要进行实名认证,<br>请填写个人真实信息领取奖品!"}},isResult:false,hpwarn:{visible:false},pwait:{visible:false}},methods:{top_btn_rule:function(){this.prule.visible=true;if(!main.scroll){main.scroll=new Scroll({container:".scroll-area",scrollObj:".scroller"})}},prule_btn_xx:function(){this.prule.visible=false},after_leave_rule:function(){main.scroll.set(0)},after_enter_rule:function(){main.scroll.update()},onPwebglEnter:function(){main.initLX({container:$(".P_webgl"),delay:3e3});main.initLX({container:$("#bg .bg2"),delay:1500});if(vm.key_index==3&&vm.server_data.prizeType==0&&!vm.server_data.is_end){$(".tip-all").show();$(".big-icon").show();$(".number").hide();$(".animation-box").fi()}},pwegbl_btn_chaxun:function(){this.pquery.visible=true},pwebgl_btn_getPrize:function(){if(!this.server_data.have_guanzhu){this.pguanzhu.visible=true;this.pwebgl.visible=false;main.stopRender();return}if(!this.server_data.isVip){var type=vm.palert.choice.reg;var content=vm.palert.txt[type];vm.openAlert(type,content);return}if(this.server_data.is_end){this.palert.type=this.palert.choice.normal;this.palert.content="本次活动已结束<br>期待EP雅莹更多活动<br>记得关注“EP雅莹官方微信”<br>敬请期待我们的下次活动";this.palert.visible=true;$(".animation-box").fo();return}var _vm=this;var callback=function(data){if(data.status){_vm.server_data.prizeType=data.lottery_result;_vm.pprize.visible=true;_vm.pwebgl.visible=false;setTimeout(function(){$(".animation-box").hide()},1e3);main.stopRender()}else{console.log("抽奖后台出问题了"+data)}};_getData.getPrize(callback)},pwebgl_btn_icon4:function(){var content="活动结束，该奖品已过期<br>下次请尽早哦！";this.openAlert("normal",content)},afterEnterPprize:function(){this.isResult=true;init_weixin_share()},afterLeavePprize:function(){this.isResult=false;init_weixin_share()},pprize_btn_paddress:function(){this.paddress.visible=true},pprize_btn_share:function(){this.pshare.visible=true},pprize_btn_pfill:function(){this.pfill.visible=true;this.pprize.visible=false},pprize_btn_close:function(){main.startRender();this.pprize.visible=false;this.pwebgl.visible=true},pquery_btn_paddress:function(){this.paddress.visible=true},pquery_btn_share:function(){this.pshare.visible=true},pquery_btn_xx:function(){this.pquery.visible=false},pfill_btn_submit:function(){var number=this.server_data.tel;var name=this.server_data.name;var patt=/^1(3|4|5|7|8)\d{9}$/;if(name==""){this.palert.type=this.palert.choice.normal;this.palert.content="请输入姓名";this.palert.visible=true;return}if(!patt.test(number)){this.palert.type=this.palert.choice.normal;this.palert.content="请输入正确的手机号";this.palert.visible=true;return}if(this.server_data.select_province==""){this.palert.type=this.palert.choice.normal;this.palert.content="请选择省份";this.palert.visible=true;return}if(this.server_data.select_city==""){this.palert.type=this.palert.choice.normal;this.palert.content="请选择城市";this.palert.visible=true;return}if(this.server_data.select_address==""){this.palert.type=this.palert.choice.normal;this.palert.content="请选择门店";this.palert.visible=true;return}var callback=function(result){if(result.status){location.href="index.php"}else{console.log(result)}};_uploadData.addInfo(callback)},onPfillProvinceChangeHandle:function(e){var _vm=this;_getData.getCity(function(data){_vm.server_data.city=data.data})},onPfillCityChangeHandle:function(e){var _vm=this;_getData.getShop(function(data){_vm.server_data.address=data.data})},onPfillAddressChangeHandle:function(e){this.server_data.shop_id=e.target.selectedOptions[0].getAttribute("shopid")},onPaddress_btn_xx:function(){this.paddress.visible=false},onPaddressProvinceChangeHandle:function(e){var _vm=this;_getData.getCity(function(data){_vm.server_data.city=data.data})},onPaddressCityChangeHandle:function(e){var _vm=this;_getData.getShop(function(data){_vm.server_data.address=data.data})},onPaddressAddressChangeHandle:function(e){},back:function(){var len=this.router.length;if(len>0){var page=this.router[len-1];this[page].visible=true;this.router.splice(len-1,1)}},palert_btn_gofill:function(){this.pfill.visible=true;this.closeAlert()},palert_btn_goregist:function(){var back_url="http://epshow.i-creative.cn/summer/index.php?is_reg=1";location.href="http://o2o.elegant-prosper.com/EPWXSiteNew/VIP/CreateVIP?sid=cfe404ea-fe5b-4a85-87f0-b2701929462c&redirect_uri="+encodeURIComponent(back_url)},onPshareEnter:function(){},openAlert:function(type,content,fontSize){var fontSize=fontSize?fontSize:"";this.palert.type=type;this.palert.content=content;this.palert.visible=true;this.palert.fontSize=fontSize},closeAlert:function(){this.palert.visible=false;this.palert.type="";this.palert.content="";this.palert.fontSize=""}},computed:{},delimiters:["$[","]"]};var vm=new Vue(options);vm.ploading.visible=true;var three=new function(){this.container;this.scene;this.camera;this.renderer;this.width;this.height;this.raycaster};three.init=function(){this.container=$("#WebGL");this.width=window.innerWidth;this.height=window.innerHeight;this.scene=new THREE.Scene;this.camera=new THREE.PerspectiveCamera(45,this.width/this.height,.1,1e4);this.camera.position.y=50;this.camera.position.z=1600;this.ocamera=new THREE.OrthographicCamera(-this.width/2,this.width/2,this.height/2,-this.height/2,1,1e3);this.ocamera.position.y=50;this.ocamera.position.z=15;this.scene2=new THREE.Scene;this.renderer=new THREE.WebGLRenderer({antialias:true,alpha:true,precision:"highp"});this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(this.width,this.height);this.renderer.autoClear=false;this.container.append(this.renderer.domElement);this.raycaster=new THREE.Raycaster;this.ddsloader=new THREE.DDSLoader;THREE.Loader.Handlers.add(/\.dds$/i,this.ddsloader)};three.loadOBJ=function(config){config=config?config:{};config.modelName=config.modelName?config.modelName:function(){console.error("加载obj文件，modelName不能为空");return}();config.objFile=config.objFile?config.objFile:function(){console.error("加载obj文件，fileName不能为空");return}();config.material=config.material?config.material:undefined;config.needTouch=typeof config.needTouch=="boolean"?config.needTouch:true;config.callback=config.callback?config.callback:undefined;var objloader=new THREE.OBJLoader;if(config.material){objloader.setMaterials(config.material);console.log(config.material)}objloader.load(config.objFile,function(group){config.callback&&config.callback(group);group.name=config.modelName;group.position.x=webgl.OBJData[config.modelName].position.x;group.position.y=webgl.OBJData[config.modelName].position.y;group.position.z=webgl.OBJData[config.modelName].position.z;group.rotation.x=webgl.OBJData[config.modelName].rotation.x;group.rotation.y=webgl.OBJData[config.modelName].rotation.y;group.rotation.z=webgl.OBJData[config.modelName].rotation.z;group.scale.x=webgl.OBJData[config.modelName].scale.x;group.scale.y=webgl.OBJData[config.modelName].scale.y;group.scale.z=webgl.OBJData[config.modelName].scale.z;webgl.OBJData[config.modelName].obj=group;if(webgl.OBJData[config.modelName].needTouch){webgl.touchObjects.push(object)}main.loader.haveLoad++;var completePercent=Math.round(main.loader.haveLoad/main.loader.total*100);$(".num").html(100-completePercent);if(main.loader.haveLoad==main.loader.total){main.loadCallBack()}},function(progress){},function(error){console.log("加载obj出错")})};three.loadMTL=function(config){config=config?config:{};config.modelName=config.modelName?config.modelName:function(){console.error("加载mtl文件，modelName不能为空");return}();config.mtlFile=config.mtlFile?config.mtlFile:function(){console.error("加载mtl文件，文件名不能为空");return}();var mtlloader=new THREE.MTLLoader;if(config.baseUrl){mtlloader.setPath(config.baseUrl)}mtlloader.load(config.mtlFile,function(materials){materials.preload();if(config.objFile){three.loadOBJ({modelName:config.modelName,objFile:config.objFile,material:materials})}},function(res){},function(res){console.log("加载mtl出错")})};three.loadCollada=function(config){config=config?config:{};config.url=config.url;config.successCallback=typeof config.successCallback=="function"?config.successCallback:function(collada){console.log(collada)};config.progressCallback=config.progressCallback?config.progressCallback:function(progress){console.log(progress)};config.failCallback=config.failCallback?config.failCallback:function(fail){console.log(fail)};var loader=new THREE.ColladaLoader;loader.load(config.url,config.successCallback,config.progressCallback,config.failCallback)};three.loadTexture=function(config){config=config?config:{};config.url=config.url?config.url:"";config.name=config.name?config.name:"";config.wrapS=typeof config.wrapS=="boolean"?config.wrapS:false;config.wrapT=typeof config.wrapT=="boolean"?config.wrapT:false;config.SuccessCallback=typeof config.SuccessCallback=="function"?config.SuccessCallback:function(){};var textureLoader=new THREE.TextureLoader;textureLoader.setCrossOrigin("");var texture=textureLoader.load(config.url,function(texture){config.SuccessCallback(texture)},undefined,function(){});if(config.wrapS){texture.wrapS=THREE.RepeatWrapping}if(config.wrapT){texture.wrapT=THREE.RepeatWrapping}texture.name=config.name;return texture};three.loadAudio=function(config){var audioLoader=new THREE.AudioLoader};three.getSpotLight=function(config){config=config?config:{};config.color=config.color?config.color:16777215;config.intensity=config.intensity?config.intensity:1;config.distance=config.distance?config.distance:100;config.angle=config.angle?config.angle:Math.PI/3;config.exponent=config.exponent?config.exponent:10;var light=new THREE.SpotLight(config.color,config.intensity,config.distance,config.angle,config.exponent);light.position.x=100;light.position.y=100;light.position.z=0;return light};three.getPointLightHelper=function(spotLight){if(spotLight instanceof THREE.Light){return new THREE.SpotLightHelper(spotLight)}};three.getDirectionalLight=function(config){config=config?config:{};config.color=config.color?config.color:16777215;config.intensity=config.intensity?config.intensity:1;var light=new THREE.DirectionalLight(config.color,config.intensity);if(config.position){light.position.set(config.position.x,config.position.y,config.position.z)}return light};three.getAmbientLight=function(config){config=config?config:{};config.color=config.color?config.color:16777215;config.intensity=config.intensity?config.intensity:1;var light=new THREE.AmbientLight(config.color,config.intensity);return light};three.getSkyByCubeGeo=function(config){var path="assets/texture/";config=config?config:{};config.size=config.size?config.size:1024;config.format=config.format?config.format:".jpg";config.urls=config.urls?config.urls:[path+"right"+config.format,path+"left"+config.format,path+"up"+config.format,path+"down"+config.format,path+"front"+config.format,path+"back"+config.format];var materials=[];for(var i=0;i<config.urls.length;i++){materials.push(new THREE.MeshLambertMaterial({map:this.loadTexture({url:config.urls[i]}),side:THREE.BackSide}))}var mesh=new THREE.Mesh(new THREE.CubeGeometry(config.size,config.size,config.size),new THREE.MeshFaceMaterial(materials));return mesh};three.getSkyBySphere=function(config){config=config?config:{};config.R=config.R?config.R:50;config.Ws=config.Ws?config.Ws:8;config.Hs=config.Hs?config.Hs:6;config.phiStart=config.phiStart?config.phiStart:0;config.phiLength=config.phiLength?config.phiLength:2*Math.PI;config.thetaStart=config.thetaStart?config.thetaStart:0;config.thetaLength=config.thetaLength?config.thetaLength:Math.PI;config.texture=config.texture?config.texture:new THREE.Texture;var geometry=new THREE.SphereGeometry(config.R,config.Ws,config.Hs,config.phiStart,config.phiLength,config.thetaStart,config.thetaLength);var material=new THREE.MeshBasicMaterial({map:config.texture,side:THREE.DoubleSide});var mesh=new THREE.Mesh(geometry,material);return mesh};three.getCubeGeometry=function(config){config=config?config:{};config.sizeX=config.sizeX?config.sizeX:100;config.sizeY=config.sizeY?config.sizeY:100;config.sizeZ=config.sizeZ?config.sizeZ:100;config.Xs=config.Xs?config.Xs:1;config.Ys=config.Ys?config.Ys:1;config.Zs=config.Zs?config.Zs:1;var geometry=new THREE.CubeGeometry(config.sizeX,config.sizeY,config.sizeZ,config.Xs,config.Ys,config.Zs);return geometry};three.getPlaneGeo=function(config){config=config?config:{};config.width=config.width?config.width:50;config.height=config.height?config.height:50;config.Ws=config.Ws?config.Ws:1;config.Hs=config.Hs?config.Hs:1;var planeGeo=new THREE.PlaneGeometry(config.width,config.height,config.Ws,config.Hs);return planeGeo};three.getSphereGeometry=function(config){config=config?config:{};config.R=config.R?config.R:50;config.Ws=config.Ws?config.Ws:8;config.Hs=config.Hs?config.Hs:6;config.phiStart=config.phiStart?config.phiStart:0;config.phiLength=config.phiLength?config.phiLength:2*Math.PI;config.thetaStart=config.thetaStart?config.thetaStart:0;config.thetaLength=config.thetaLength?config.thetaLength:Math.PI;var geometry=new THREE.SphereGeometry(config.R,config.Ws,config.Hs,config.phiStart,config.phiLength,config.thetaStart,config.thetaLength);return geometry};three.getPointMaterial=function(config){config=config?config:{};config.size=config.size?config.size:4;config.map=config.map?config.map:undefined;config.blending=config.blending?config.blending:THREE.AdditiveBlending};three.getOrbitControls=function(config){config=config?config:{};return new THREE.OrbitControls(this.camera,this.renderer.domElement)};three.addPerspectiveCameraHelper=function(camera){camera=camera?camera:this.camera;var helper=new THREE.CameraHelper(camera);this.scene.add(helper);return helper};three.getFps=function(){var s=new Stats;return s};three.getObjectByName=function(config){config=config?config:{};config.name=config.name?config.name:function(){console.error("getObjectByName时缺少name")}();config.scene=config.scene?config.scene:this.scene;return config.scene.getObjectByName(config.name)};three.raycasterResult=function(config){config=config?config:{};config.coords=config.coords?config.coords:new THREE.Vector2;config.searchFrom=config.searchFrom?config.searchFrom:this.scene;config.recursive=config.recursive?config.recursive:false;config.needGroup=config.needGroup?config.needGroup:false;config.coords.x=config.coords.x/this.width*2-1;config.coords.y=2*-(config.coords.y/this.height)+1;this.raycaster.setFromCamera(config.coords,this.camera);var result;result=this.raycaster.intersectObjects(config.searchFrom,config.recursive);if(result.length>0){if(config.needGroup){if(result[0].object.parent&&result[0].object.parent instanceof THREE.Group){result=result[0].object.parent}}else{result=result[0]}}else{result=undefined}return result};three.getTime=function(){return(new Date).getTime()};three.getTouchCoords=function(event){return{x:event.offsetX,y:event.offsetY}};three.render=function(){this.renderer.clear();this.renderer.render(this.scene,this.camera);this.renderer.clearDepth();this.renderer.render(this.scene2,this.ocamera)};three.onresize=function(){this.width=this.container.width();this.height=this.container.height();this.camera.aspect=this.width/this.height;this.camera.updateProjectionMatrix();this.ocamera.left=-this.width/2;this.ocamera.right=this.width/2;this.ocamera.top=this.height/2;this.ocamera.bottom=-this.height/2;this.ocamera.updateProjectionMatrix();this.renderer.setSize(this.width,this.height)};var webgl=new function(){this.debug=true;this.fps=undefined;this.orbit=undefined;this.gravity=undefined;this.loader={haveLoad:0,total:0,complete:false};this.assetsUrl="assets/";this.picUrl=this.assetsUrl+"images/";this.texturePath=this.assetsUrl+"images/";this.modelsUrl=this.assetsUrl+"models/";this.touchObjects=[];this.OBJData={scene:{name:"scene",baseUrl:this.assetsUrl,mtlFile:this.assetsUrl+"models/scene/scene.mtl",objFile:this.assetsUrl+"models/scene/scene.obj",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:.07,y:.07,z:.07},needTouch:false,liusu_center:undefined,liusu_up:undefined}};this.TextureData={};const SQ3=Math.sqrt(3);const SQ2=Math.sqrt(2);this.skyBox=undefined;this.earthChangeTexture=[];this.textureIndex=0;this.ogroup=new THREE.Group;this.clock=new THREE.Clock};webgl.init=function(){this.loader.total=Object.keys(this.OBJData).length};webgl.load=function(){for(var prop in this.OBJData){var config=this.OBJData[prop];three.loadOBJ({modelName:config.name,objFile:config.objFile,callback:function(group){webgl.stone1=group.children[0];webgl.stone2=group.children[1];webgl.liusu_up=group.children[2];webgl.liusu_center=group.children[3];webgl.planet=group.children[4]}})}};webgl.loadCallback=function(){for(var i=1;i<=38;i++){var texture=three.loadTexture({url:main.modelsUrl+"scene/ls/"+i+".png"});this.earthChangeTexture.push(texture)}this.addAmbientLight();this.addDirectionLight();this.addEarth();this.addCross();this.addOrbit();this.orbit.enabled=false;this.orbit.enableZoom=false;this.orbit.rotateSpeed=.5};webgl.addAmbientLight=function(){var ambientLight=three.getAmbientLight({color:0,intensity:1});three.scene.add(ambientLight)};webgl.addDirectionLight=function(){var directionLight=three.getDirectionalLight({color:1118481,intensity:.1,position:{x:0,y:300,z:0}});three.scene.add(directionLight);if(this.debug){var helper=new THREE.DirectionalLightHelper(directionLight)}};webgl.addOrbit=function(){this.orbit=new THREE.OrbitControls(three.camera,$("#gl-touch")[0]);this.orbit.enableZoom=true;this.orbit.target=webgl.earthGroup.position};webgl.addGravity=function(){this.gravity=new THREE.DeviceOrientationControls(this.sky)};webgl.addEarth=function(){var group=new THREE.Group;group.scale.set(0,0,0);group.position.set(0,50,-200);group.rotation.y=2*Math.PI;var material=new THREE.MeshPhongMaterial({map:three.loadTexture({url:this.assetsUrl+"models/scene/planet.png"}),normalMap:three.loadTexture({url:this.assetsUrl+"models/scene/normal_planet.png"}),shininess:20,emissive:1118481,emissiveIntensity:0});this.planet.material=material;group.add(this.planet);var material3=new THREE.MeshLambertMaterial({color:"white",map:three.loadTexture({url:this.assetsUrl+"models/scene/ls/1.png"}),side:THREE.DoubleSide,depthWrite:false,transparent:true,opacity:.8});this.liusu_up.material=material3;this.liusu_up.scale.set(1.01,1.01,1.01);this.liusu_up.rotation.set(2,2,2);group.add(this.liusu_up);var material4=new THREE.MeshLambertMaterial({color:"white",map:three.loadTexture({url:this.assetsUrl+"models/scene/ls/1.png"}),side:THREE.DoubleSide,depthWrite:false,transparent:true,opacity:.8});this.liusu_center.material=material4;this.liusu_center.scale.set(1.01,1.01,1.01);this.liusu_center.rotation.set(1.01,1.01,1.01);group.add(this.liusu_center);this.earthGroup=group;three.scene.add(group);for(point in this.PointData){var points=this.PointData;var point=points[point];point.texture=three.loadTexture({url:point.texture});var RedPoint2=new THREE.Sprite(new THREE.SpriteMaterial({map:point.texture,depthWrite:false}));RedPoint2.position.set(point.position.x,point.position.y,point.position.z);RedPoint2.scale.set(point.width*1.3,point.width*1.3,1);group.add(RedPoint2);RedPoint2.name=point.name;point.obj=RedPoint2}};webgl.addStars=function(){var texture=three.loadTexture({url:this.picUrl+"star2.png"});var mat=new THREE.SpriteMaterial({map:texture,transparent:true,depthWrite:false});this.stars=new THREE.Group;for(var i=0;i<200;i++){var axis=parseInt(Math.random()*3);switch(axis){case 0:var x=THREE.Math.randFloat(800,1e3);var y=THREE.Math.randFloat(0,1e3);var z=THREE.Math.randFloat(0,1e3);break;case 1:var x=THREE.Math.randFloat(0,1e3);var y=THREE.Math.randFloat(800,1e3);var z=THREE.Math.randFloat(0,1e3);break;case 2:var x=THREE.Math.randFloat(0,1e3);var y=THREE.Math.randFloat(0,1e3);var z=THREE.Math.randFloat(800,1e3);break}var flag=Math.random()-.5>0?1:-1;x*=flag;flag=Math.random()-.5>0?1:-1;y*=flag;flag=Math.random()-.5>0?1:-1;z*=flag;var sprite=new THREE.Sprite(mat);var rand=THREE.Math.randFloat(30,50);sprite.scale.set(rand,rand,1);sprite.position.set(x,y,z);this.stars.add(sprite)}three.scene.add(this.stars)};webgl.addSky=function(){var skyMesh=three.getSkyByCubeGeo({size:2048});this.sky=skyMesh;three.scene.add(skyMesh)};webgl.addCross=function(){var texture=three.loadTexture({url:main.picUrl+"p1-miaozhun.png"});var material=new THREE.SpriteMaterial({map:texture});var sprite=new THREE.Sprite(material);sprite.position.set(0,50,0);sprite.scale.set(40,40,1);three.scene2.add(sprite)};webgl.updateStar=function(){var number=this.stars.children.length;for(var i=0;i<number;i++){var rand=parseInt(10*Math.random());TweenMax.fromTo(this.stars.children[i].material,1,{opacity:1},{opacity:0,repeat:-1,yoyo:true})}};webgl.addFps=function(){this.fps=three.getFps();document.getElementById("FPS").appendChild(this.fps.domElement)};webgl.addAxisHelper=function(){var helper=new THREE.AxisHelper(1e3);three.scene.add(helper)};webgl.updateTexture=function(){this.liusu_center.material.map=this.earthChangeTexture[this.textureIndex];this.liusu_up.material.map=this.earthChangeTexture[this.textureIndex];this.liusu_center.material.needsUpdate=true;this.liusu_up.material.needsUpdate=true;this.liusu_center.rotation.x+=.001;this.liusu_center.rotation.y+=.001;this.liusu_center.rotation.z+=.001;this.liusu_up.rotation.x+=.001;this.liusu_up.rotation.y+=.001;this.liusu_up.rotation.z+=.001;if(this.textureIndex<this.earthChangeTexture.length-1){this.textureIndex++}else{this.textureIndex=0}};webgl.render=function(){this.clock.startTime=Date.now();if(this.clock.startTime-this.clock.oldTime>50){this.updateTexture();this.clock.oldTime=this.clock.startTime}};var main=new function(){this.touch={ScrollObj:undefined,isScroll:false,limitUp:0,limitDown:undefined,overlimit:false,lastX:0,lastY:0,newX:0,newY:0,delta_X:0,delta_Y:0,scrollY:0,touchAllow:true,fingerNumber:0,distance:0,angle:0,delta_angle:0,time:0,offsetTime:0};this.bgm={obj:document.getElementById("bgm"),id:"bgm",isPlay:false,button:$(".music-btn")};this.V={id:"video",currentTime:0,isPlay:false,obj:document.getElementById("video")};this.assetsUrl="assets/";this.picUrl=this.assetsUrl+"images/";this.ImageList=[{url:this.picUrl+"bg.jpg",group:"1"},{url:this.picUrl+"p6-kuang.png",group:"1"},{url:this.picUrl+"p11-btn.png",group:"1"},{url:this.picUrl+"p11-kuang.png",group:"1"},{url:this.picUrl+"pfill-title.png",group:"1"},{url:this.picUrl+"pfill-txt-3.png",group:"1"},{url:this.picUrl+"phone.png",group:"1"},{url:this.picUrl+"weile.png",group:"1"}];this.RAF=undefined};main.init=function(){three.init();webgl.init()};main.start=function(){var loader=new Utils.ImageLoader;loader.load(this.ImageList,function(percent){console.log(percent)},function(result){console.log(result)})};main.loadCallBack=function(){};main.prule=function(){$(".P_rule").fi();main.scrollInit(".rule-txt",0)};main.prulelaeve=function(){$(".P_rule").fo(function(){$(".rule-txt")[0].style.webkitTransform="translate3d(0,0,0)"})};main.scrollInit=function(selector){this.touch.ScrollObj=$(selector);this.touch.container=$(selector).parent();this.touch.StartY=0;this.touch.NewY=0;this.touch.addY=0;this.touch.scrollY=0;this.touch.limitDown=this.touch.ScrollObj.height()<this.touch.container.height()?0:this.touch.container.height()-this.touch.ScrollObj.height()};main.limitNum=function(obj){var value=obj.value;var length=value.length;if(length>11){value=value.substring(0,11);obj.value=value}};main.playbgm=function(){Media.playMedia(this.bgm.id);this.bgm.button.addClass("ani-bgmRotate");this.bgm.isPlay=true};main.pausebgm=function(){this.bgm.obj.pause();this.bgm.button.removeClass("ani-bgmRotate");this.bgm.isPlay=false};main.startRender=function(){var loop=function(){main.RAF=window.requestAnimationFrame(loop)};loop()};main.stopRender=function(){window.cancelAnimationFrame(main.RAF)};main.addEvent=function(){$(window).on("orientationchange",function(e){if(window.orientation==0||window.orientation==180){vm.hpwarn.visible=false}else if(window.orientation==90||window.orientation==-90){vm.hpwarn.visible=true}})};main.addEvent();main.init();